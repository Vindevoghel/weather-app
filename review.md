.Nice code and clear 
.there are not many golobal variable
.there are magical number 
.could use comment for later to remember 